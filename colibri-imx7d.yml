header:
  version: 11

distro: poky

defaults:
  repos:
    refspec: master

repos:
  poky:
    url: https://git.yoctoproject.org/git/poky
    refspec: kirkstone
    layers:
      meta:
      meta-poky:

  meta-zephyr:
    url: https://git.yoctoproject.org/git/meta-zephyr
    refspec: master
    layers:
      meta-zephyr-core:
      meta-zephyr-bsp:

  meta-openembedded:
    url: https://git.openembedded.org/meta-openembedded
    refspec: kirkstone
    layers:
      meta-oe:
      meta-python:

  meta-mender:
    url: https://github.com/mendersoftware/meta-mender.git
    refspec: master-next
    layers:
      meta-mender-core:

  meta-mender-community:
    url: https://github.com/theyoctojester/meta-mender-community.git
    refspec: colibri-imx7-emmc_kirkstone
    layers:
      meta-mender-toradex-nxp:

  meta-freescale:
    url: https://github.com/Freescale/meta-freescale.git
    refspec: kirkstone

  meta-freescale-3rdparty:
    url: https://github.com/Freescale/meta-freescale-3rdparty.git
    refspec: kirkstone

  meta-toradex-bsp-common:
    url: https://git.toradex.com/meta-toradex-bsp-common.git
    refspec: master

  meta-toradex-nxp:
    url: https://git.toradex.com/meta-toradex-nxp.git
    refspec: master
  
  meta-zirconium:

local_conf_header:
  base: |
    CONF_VERSION = "2"
    PACKAGE_CLASSES = "package_ipk"
    INIT_MANAGER = "systemd"
    ACCEPT_FSL_EULA = "1" 
    EXTRA_IMAGE_FEATURES ?= "debug-tweaks"
    INHERIT += "cve-check"
  
  tmp: |
    TMPDIR = "${TOPDIR}/tmp-colibri-imx7d"

  multiconfig_m4: |
    BBMULTICONFIG = "zephyr-m4"

  toradex: |
    include conf/machine/include/colibri-imx7-emmc.inc
    KBRANCH:pn-linux-toradex-mainline = "linux-5.18.y"

  mender: |
    INHERIT += "mender-full mender-toradex"
    MENDER_FEATURES_ENABLE:append = " mender-uboot mender-image mender-image-sd"
    MENDER_FEATURES_DISABLE:append = " mender-grub mender-image-uefi"
    IMAGE_CLASSES += "image_type_mender_tezi"
    IMAGE_FSTYPES:append = " mender_tezi"
    MENDER_STORAGE_TOTAL_SIZE_MB = "3072"
    MENDER_ARTIFACT_NAME = "zirconium1"
    MENDER_STORAGE_DEVICE = "/dev/mmcblk2"
    TEZI_STORAGE_DEVICE = "mmcblk0"
    MENDER_UBOOT_STORAGE_INTERFACE = "mmc"
    MENDER_UBOOT_STORAGE_DEVICE = "0"

target:
  - zirconium-image

machine: colibri-imx7-emmc
